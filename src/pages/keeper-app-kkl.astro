---
import Layout from '../layouts/Layout.astro';
import KeeperApp from '../components/KeeperApp.jsx';
const KeeperAppAny: any = KeeperApp;

// 1. Fetch the data on the server (No CORS issues here!)
const MFL_URL = "https://www47.myfantasyleague.com/2025/options?L=45267&O=07&PRINTER=1";
let initialCsvData = "";

try {
  const response = await fetch(MFL_URL);
  if (response.ok) {
    initialCsvData = await response.text();
  } else {
    console.error("Failed to fetch MFL data:", response.statusText);
  }
} catch (error) {
  console.error("Error fetching MFL data:", error);
}
---

<Layout title="KKL Keeper Manager">
  <main>
    {/* 2. Pass the data directly to the React component */}
    <KeeperAppAny client:load initialData={initialCsvData} />
  </main>
</Layout>

<style is:global>
  @import url('https://fonts.googleapis.com/css2?family=Bebas+Neue&family=Space+Mono:wght@400;700&display=swap');
</style>